{
  "openapi": "3.1.0",
  "x-stoplight": {
    "id": "uqil016p15kvu"
  },
  "info": {
    "title": "Compatibility",
    "version": "1.0"
  },
  "servers": [
    {
      "url": "http://localhost:3000"
    }
  ],
  "paths": {
    "/app-compatibility": {
      "get": {
        "summary": "App compatibility information",
        "tags": [],
        "responses": {
          "200": {
            "description": "OK",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AppCompatibility"
                }
              }
            }
          },
          "400": {
            "description": "Bad Request"
          }
        },
        "operationId": "get-app-compatibility",
        "parameters": [
          {
            "in": "query",
            "name": "app_type",
            "schema": {
              "type": "string",
              "enum": ["DESKTOP", "FLUTTER", "WEB"]
            },
            "required": true,
            "description": "the installed app's type"
          },
          {
            "schema": {
              "type": "string",
              "example": "4.0.1"
            },
            "in": "query",
            "name": "app_version",
            "required": true,
            "description": "the installed app's current version"
          },
          {
            "schema": {
              "type": "string",
              "enum": ["SMARTPHONE", "TABLET", "DESKTOP"]
            },
            "in": "query",
            "name": "device_type",
            "description": "generalized device type",
            "required": true
          },
          {
            "schema": {
              "type": "string",
              "enum": ["IOS", "ANDROID", "WINDOWS", "LINUX", "MACOS", "OTHER"]
            },
            "in": "query",
            "name": "os_family",
            "description": "operation system identifier",
            "required": true
          },
          {
            "schema": {
              "type": "string",
              "example": "16.0"
            },
            "in": "query",
            "name": "os_version",
            "description": "version of the operation system",
            "required": true
          },
          {
            "schema": {
              "type": "string"
            },
            "in": "query",
            "name": "os_api_level",
            "description": "api level (used for android only)"
          },
          {
            "schema": {
              "type": "string"
            },
            "in": "query",
            "name": "organization_id",
            "description": "organization identifier in case of a branded app installation"
          },
          {
            "schema": {
              "type": "string",
              "example": "en-US",
              "minLength": 2,
              "maxLength": 5
            },
            "in": "header",
            "name": "Accept-Language",
            "description": "preferred language for localized messages"
          }
        ],
        "x-internal": true,
        "description": "Returns compatibility information for Flip-managed apps."
      }
    }
  },
  "components": {
    "schemas": {
      "AppCompatibility": {
        "title": "AppCompatibility",
        "x-stoplight": {
          "id": "qaof83aholfz7"
        },
        "type": "object",
        "x-internal": true,
        "properties": {
          "required_actions": {
            "$ref": "#/components/schemas/RequiredAppCompatibilityActions",
            "description": "Presence of this value indicates that some action is required for the app to function properly.\nClients should treat the presence of this value as an indicator to stop working with the remote services, even if they do not understand the specific sub properties."
          },
          "app_stores": {
            "type": "array",
            "description": "Links to app stores for updating the app",
            "items": {
              "$ref": "#/components/schemas/AppStoreInfo"
            }
          }
        },
        "required": ["app_stores"],
        "description": "Basic compatibility information for flip managed apps"
      },
      "RequiredAppCompatibilityActions": {
        "title": "RequiredAppCompatibilityActions",
        "x-stoplight": {
          "id": "jiojvk49tvt7a"
        },
        "type": "object",
        "x-internal": true,
        "description": "Information when actions are required for the app to function properly.",
        "properties": {
          "os_update": {
            "$ref": "#/components/schemas/OSUpdateRequiredCompatibilityAction",
            "description": "If present, an operation system update is required for the application to function properly."
          },
          "app_update": {
            "$ref": "#/components/schemas/AppUpdateRequiredAppCompatibilityAction",
            "description": "If present, an app update is required in order for the app to function properly."
          },
          "end_of_life": {
            "$ref": "#/components/schemas/EndOfLifeAppCompatibilityAction",
            "description": "If present, the app has reached it's end of life and should \"uninstall\" itself.\nPresence also implies that the other two values are absent."
          }
        }
      },
      "EndOfLifeAppCompatibilityAction": {
        "title": "EndOfLifeAppCompatibilityAction",
        "x-stoplight": {
          "id": "tfp57aeycoj3k"
        },
        "type": "object",
        "properties": {
          "message": {
            "$ref": "#/components/schemas/LocalizedLabel"
          }
        },
        "required": ["message"],
        "description": "Information that the client reached end of life and should cease operation.",
        "x-internal": true
      },
      "OSUpdateRequiredCompatibilityAction": {
        "title": "OSUpdateRequiredAppCompatibilityAction",
        "x-stoplight": {
          "id": "puwh5eq0ubwkp"
        },
        "type": "object",
        "description": "Information that the operation system has to be updated.",
        "properties": {
          "min_os_version": {
            "type": "string",
            "example": "8.0.1"
          },
          "message": {
            "$ref": "#/components/schemas/LocalizedLabel"
          }
        },
        "required": ["min_os_version", "message"],
        "x-internal": true
      },
      "AppUpdateRequiredAppCompatibilityAction": {
        "title": "AppUpdateRequiredAppCompatibilityAction",
        "x-stoplight": {
          "id": "lxk42mkh74ffd"
        },
        "type": "object",
        "description": "Information that the app has to be updated.",
        "properties": {
          "min_app_version": {
            "type": "string",
            "example": "4.1.0"
          },
          "message": {
            "$ref": "#/components/schemas/LocalizedLabel"
          }
        },
        "required": ["min_app_version", "message"],
        "x-internal": true
      },
      "LocalizedLabel": {
        "title": "LocalizedLabel",
        "x-stoplight": {
          "id": "3rkhdkhlqknqa"
        },
        "type": "object",
        "description": "Data structure for a dynamic localized label/message/text",
        "properties": {
          "language": {
            "$ref": "#/components/schemas/LanguageCode",
            "description": "ISO language code - this might differ from the preferred language when there is no proper translation  available."
          },
          "text": {
            "type": "string",
            "example": "This is a message"
          }
        },
        "required": ["language", "text"]
      },
      "LanguageCode": {
        "title": "LanguageCode",
        "x-stoplight": {
          "id": "7zn05h32d7grp"
        },
        "type": "string",
        "example": "en-US",
        "minLength": 2,
        "maxLength": 5,
        "description": "ISO-639-1 encoded language identifier"
      },
      "AppStoreInfo": {
        "title": "AppStoreInfo",
        "x-stoplight": {
          "id": "ersam3fxslykd"
        },
        "type": "object",
        "x-internal": true,
        "properties": {
          "id": {
            "type": "string",
            "description": "logical id of the store",
            "example": "ios_store"
          },
          "name": {
            "type": "string",
            "description": "human readable app store name",
            "example": "Apple Store"
          },
          "url": {
            "type": "string",
            "format": "uri"
          }
        },
        "required": ["id", "name", "url"]
      }
    },
    "parameters": {}
  }
}
